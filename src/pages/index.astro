---
import Categories from '@/components/Categories.astro';
import Container from '@/components/Container.astro';
import FeaturedRecipes from '@/components/FeaturedRecipes.astro';
import HeroSection from '@/components/HeroSection.astro';
import Notice from '@/components/Notice.astro';
import SectionHeader from '@/components/SectionHeader.astro';
import Tags from '@/components/Tags.astro';
import {
    getAllRecipes,
    getUniqueCategoriesWithCount,
    getUniqueTagsWithCount,
    sortRecipeByDate,
} from '@/data';
import BaseLayout from '@/layouts/BaseLayout.astro';

const recipes = await getAllRecipes();
const sortedRecipes = sortRecipeByDate(recipes);
const featuredRecipes = sortedRecipes.filter(
    (recipe) => recipe.data.isFeatured
);
const categories = getUniqueCategoriesWithCount(recipes);
const sortedCategories = categories.sort((a, b) => b[1] - a[1]);
const tags = getUniqueTagsWithCount(recipes);
const sortedTags = tags.sort((a, b) => b[1] - a[1]);
---

<BaseLayout meta={{ title: 'নীড়পাতা' }}>
    <HeroSection />
    <FeaturedRecipes recipes={featuredRecipes} />
    <Container>
        <SectionHeader>রান্নার ধরন</SectionHeader>
        <Categories categories={sortedCategories} limit={5} />
    </Container>
    <Container>
        <SectionHeader>রান্নার বিষয়</SectionHeader>
        <Tags tags={sortedTags} limit={6} />
    </Container>
    <Container>
        <Notice variant="notice">
            আপনার রেসিপি শেয়ার করতে চান?
            <a
                class="text-chilli-600 hover:text-chilli-700 font-normal underline decoration-2 underline-offset-4 duration-300 ease-in-out"
                href="/contribution-guide">এখানে বিস্তারিত দেখুন</a
            >
        </Notice>
    </Container>
</BaseLayout>
